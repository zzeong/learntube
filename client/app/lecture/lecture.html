<div id="sidenav" ng-include="'components/sidenav/sidenav.html'"></div>
<div id="header" ng-include="'components/toolbar/toolbar.html'"></div>

<md-content>

  <div class="embed-item-limit-width">
    <div class="embed-responsive embed-responsive-16by9">
      <youtube-video class="embed-responsive-item" video-id="videoId" player-vars="playerVars"></youtube-video>
    </div>
  </div>

  <div class="content-width content-background content-top-mt">

    <div class="video-info-panel md-padding">
      <div layout="row" layout-wrap>
        <div>
          <h1 class="md-title margin-zero">{{ item.snippet.title }}</h1>
        </div>
        <div class="arrow-icon">
          <md-icon md-font-set="material-icons" ng-click="showDetails()" ng-show="!details"
          class="icon-style">arrow_drop_down</md-icon>
          <md-icon md-font-set="material-icons" ng-click="showDetails()" ng-show="details"
          class="icon-style">arrow_drop_up</md-icon>
        </div>
        <div ng-show="details">
          <div class="md-body-1" ng-bind-html="item.snippet.description"></div>
          <!--
          <p class="md-body-1">{{ item.snippet.description }}</p>
          -->
          <span class="lecture-details-item md-body-2">Channel : </span>
          <span class="md-body-1">{{ item.snippet.channelTitle }}</span>
          <br>
          <span class="lecture-details-item">Hits : </span>
          <span class="md-body-1">{{ item.statistics.viewCount }}</span>
          <br>
          <span class="lecture-det  ails-item md-body-2">Upload : </span>
          <span class="md-body-1">{{ publishedDate }}</span>
          <br>

          <div class="details-footer" layout="row" layout-wrap>
            <div flex="700">
              <span>
                <md-icon md-font-set="material-icons">thumb_up</md-icon>
                <span class="lecture-details-item md-body-2">{{ item.statistics.likeCount }}</span>
              </span>
              <span>
                <md-icon md-font-set="material-icons">thumb_down</md-icon>
                <span class="lecture-details-item md-body-2">{{ item.statistics.dislikeCount }}</span>
              </span>
            </div>

            <md-button target="_self" ng-href="{{ getDownloadUrl() }}" download>
              Download handout
              <md-icon md-font-set="material-icons">file_download</md-icon>
            </md-button>
          </div>
        </div>

      </div>
      <div class="md-actions" layout="row" layout-align="end center">
        <md-menu>
          <md-button class="md-raised" ng-click="$mdOpenMenu()">Note</md-button>

          <md-menu-content width="3">
            <md-menu-item>
              <md-button ng-click="toggleEditor()">
                <md-icon md-font-set="material-icons" md-menu-align-target>description</md-icon>
                Web editor
              </md-button>
            </md-menu-item>

            <md-menu-item>
              <md-button ng-click="toggleFileUpload()">
                <md-icon md-font-set="material-icons" md-menu-align-target>file_upload</md-icon>
                File upload
              </md-button>
            </md-menu-item>
          </md-menu-content>
        </md-menu>

        <md-button class="md-raised md-primary md-hue-2" ng-click="completeLecture()">Complete</md-button>
      </div>
    </div>

    <md-divider></md-divider>

    <div ng-show="isEditorOn">
      <md-subheader>Note web editor</md-subheader>
      <form ng-submit="doneNote('editor', noteContents)">
        <textarea id="newNote" ng-model="noteContents" ckeditor></textarea>
        <div class="md-actions md-padding" layout="row" layout-align="end center">
          <md-button type="submit" class="md-raised">Done</md-button>
        </div>
      </form>
      <md-divider></md-divider>
    </div>

    <div ng-show="isFileUploadOn">
      <md-subheader>Note file uploader</md-subheader>
      <div class="md-actions md-padding" layout="row" layout-align="end center">
        <form ng-submit="doneNote('file', noteFile)">
          <input class="note-file-uploader" type="file" ngf-select ng-model="noteFile">
          <md-button type="submit" class="md-raised">Done</md-button>
        </form>
      </div>
      <md-divider></md-divider>
    </div>

    <div ng-if="isLoggedIn()">
      <section>
        <md-subheader class="md-primary">My notes</md-subheader>

        <div class="md-padding" ng-repeat="note in notes">
          <div ng-hide="note.isEditing">
            <div class="note-item">
              <img class="avatar account-thumb" ng-src="{{ getUserImgPath(getCurrentUser()) }}" alt="Account Image">
              <div class="userinfo">
                <p class="md-subhead">{{ getCurrentUser().name }}</p>
              </div>
            </div>

            <md-divider></md-divider>

            <div class="note-contents-viewer">
              <iframe ng-if="shouldBeEmbedded(note)" ng-src="{{ note.url | trustAsResourceUrl }}"></iframe>
              <img ng-if="!shouldBeEmbedded(note)" ng-src="{{ note.url }}" alt="My lecture note">
            </div>

            <div class="md-actions" layout="row" layout-align="end center">
              <md-button class="md-raised" ng-if="note.type === 'editor'" ng-click="editNote(note)">Edit</md-button>
              <md-button class="md-raised md-warn" ng-click="deleteNote(note)">Delete</md-button>
            </div>
          </div>

          <div ng-if="note.isEditing">
            <form ng-submit="updateNote(note)">
              <textarea ng-model="note.contents" ckeditor></textarea>
              <md-button class="md-raised md-warn" ng-click="cancelEditing(note)">Cancel</md-button>
              <md-button type="submit" class="md-raised">Update</md-button>
            </form>
          </div>
        </div>

      </section>
    </div>

    <section>
      <md-subheader class="md-primary">Others notes</md-subheader>
      <div class="others-notes-cont">
        <div class="md-padding" ng-repeat="note in othersNotes">
          <div class="note-item">
            <img class="avatar account-thumb" ng-src="{{ note.userId.google.image.url }}" alt="Account Image">
            <div class="userinfo">
              <p class="md-subhead">{{ note.userId.name }}</p>
            </div>
          </div>

          <md-divider></md-divider>

          <div class="note-contents-viewer">
            <iframe ng-if="shouldBeEmbedded(note)" ng-src="{{ note.url | trustAsResourceUrl }}"></iframe>
            <img ng-if="!shouldBeEmbedded(note)" ng-src="{{ note.url }}" alt="My lecture note">
          </div>
        </div>
      </div>
    </section>

  </div>
</md-content>

